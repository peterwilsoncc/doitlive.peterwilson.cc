{"version":3,"file":"./build/admin-manifest/index.min.js","mappings":"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","sources":["webpack://wp/webpack/bootstrap","webpack://wp/webpack/runtime/make namespace object","webpack://wp/external window [\"wp\",\"url\"]","webpack://wp/./packages/admin-manifest/build-module/@wordpress/admin-manifest/src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"url\"];","/**\n * WordPress dependencies\n */\nimport { addQueryArgs } from '@wordpress/url';\n\nfunction addManifest( manifest ) {\n\tconst link = document.createElement( 'link' );\n\tlink.rel = 'manifest';\n\tlink.href = `data:application/manifest+json,${ encodeURIComponent(\n\t\tJSON.stringify( manifest )\n\t) }`;\n\tdocument.head.appendChild( link );\n}\n\nfunction addAppleTouchIcon( size, base64data ) {\n\tconst iconLink = document.createElement( 'link' );\n\ticonLink.rel = 'apple-touch-icon';\n\ticonLink.href = base64data;\n\ticonLink.sizes = '180x180';\n\tdocument.head.insertBefore( iconLink, document.head.firstElementChild );\n}\n\nfunction createSvgElement( html ) {\n\tconst doc = document.implementation.createHTMLDocument( '' );\n\tdoc.body.innerHTML = html;\n\tconst { firstElementChild: svgElement } = doc.body;\n\tsvgElement.setAttribute( 'viewBox', '0 0 80 80' );\n\treturn svgElement;\n}\n\nfunction createIcon( { svgElement, size, color, backgroundColor, circle } ) {\n\treturn new Promise( ( resolve ) => {\n\t\tconst canvas = document.createElement( 'canvas' );\n\t\tconst context = canvas.getContext( '2d' );\n\n\t\t// Leave 1/8th padding around the logo.\n\t\tconst padding = size / 8;\n\t\t// Which leaves 3/4ths of space for the icon.\n\t\tconst logoSize = padding * 6;\n\n\t\t// Resize the SVG logo.\n\t\tsvgElement.setAttribute( 'width', logoSize );\n\t\tsvgElement.setAttribute( 'height', logoSize );\n\n\t\t// Color in the background.\n\t\tsvgElement.querySelectorAll( 'path' ).forEach( ( path ) => {\n\t\t\tpath.setAttribute( 'fill', backgroundColor );\n\t\t} );\n\n\t\t// Resize the canvas.\n\t\tcanvas.width = size;\n\t\tcanvas.height = size;\n\n\t\t// If we're not drawing a circle, set the background color.\n\t\tif ( ! circle ) {\n\t\t\tcontext.fillStyle = backgroundColor;\n\t\t\tcontext.fillRect( 0, 0, canvas.width, canvas.height );\n\t\t}\n\n\t\t// Fill in the letter (W) and circle around it.\n\t\tcontext.fillStyle = color;\n\t\tcontext.beginPath();\n\t\tcontext.arc( size / 2, size / 2, logoSize / 2 - 1, 0, 2 * Math.PI );\n\t\tcontext.closePath();\n\t\tcontext.fill();\n\n\t\t// Create a URL for the SVG to load in an image element.\n\t\tconst svgBlob = new window.Blob( [ svgElement.outerHTML ], {\n\t\t\ttype: 'image/svg+xml',\n\t\t} );\n\t\tconst url = URL.createObjectURL( svgBlob );\n\t\tconst image = document.createElement( 'img' );\n\n\t\timage.src = url;\n\t\timage.width = logoSize;\n\t\timage.height = logoSize;\n\t\timage.onload = () => {\n\t\t\t// Once the image is loaded, draw it onto the canvas.\n\t\t\tcontext.drawImage( image, padding, padding );\n\t\t\t// Export it to a blob.\n\t\t\tcanvas.toBlob( ( imageBlob ) => {\n\t\t\t\t// We no longer need the SVG blob url.\n\t\t\t\tURL.revokeObjectURL( url );\n\t\t\t\t// Unfortunately blob URLs don't seem to work, so we have to use\n\t\t\t\t// base64 encoded data URLs.\n\t\t\t\tconst reader = new window.FileReader();\n\t\t\t\treader.readAsDataURL( imageBlob );\n\t\t\t\treader.onloadend = () => {\n\t\t\t\t\tresolve( reader.result );\n\t\t\t\t};\n\t\t\t} );\n\t\t};\n\t} );\n}\n\nfunction getAdminBarColors() {\n\tconst adminBarDummy = document.createElement( 'div' );\n\tadminBarDummy.id = 'wpadminbar';\n\tdocument.body.appendChild( adminBarDummy );\n\tconst { color, backgroundColor } = window.getComputedStyle( adminBarDummy );\n\tdocument.body.removeChild( adminBarDummy );\n\t// Fall back to black and white if no admin/color stylesheet was loaded.\n\treturn {\n\t\tcolor: color || 'white',\n\t\tbackgroundColor: backgroundColor || 'black',\n\t};\n}\n\nwindow.addEventListener( 'load', () => {\n\tif ( ! ( 'serviceWorker' in window.navigator ) ) {\n\t\treturn;\n\t}\n\n\tconst { logo, siteTitle, adminUrl } = window.wpAdminManifestL10n;\n\tconst manifest = {\n\t\tname: siteTitle,\n\t\tdisplay: 'standalone',\n\t\torientation: 'portrait',\n\t\tstart_url: adminUrl,\n\t\t// Open front-end, login page, and any external URLs in a browser\n\t\t// modal.\n\t\tscope: adminUrl,\n\t\ticons: [],\n\t};\n\n\tconst { color, backgroundColor } = getAdminBarColors();\n\tconst svgElement = createSvgElement( logo );\n\n\tPromise.all( [\n\t\t// The maskable icon should have its background filled. This is used\n\t\t// for iOS. To do: check which sizes are really needed.\n\t\t...[ 180, 192, 512 ].map( ( size ) =>\n\t\t\tcreateIcon( {\n\t\t\t\tsvgElement,\n\t\t\t\tsize,\n\t\t\t\tcolor,\n\t\t\t\tbackgroundColor,\n\t\t\t} ).then( ( base64data ) => {\n\t\t\t\tmanifest.icons.push( {\n\t\t\t\t\tsrc: base64data,\n\t\t\t\t\tsizes: size + 'x' + size,\n\t\t\t\t\ttype: 'image/png',\n\t\t\t\t\tpurpose: 'maskable',\n\t\t\t\t} );\n\n\t\t\t\t// iOS doesn't seem to look at the manifest.\n\t\t\t\tif ( size === 180 ) {\n\t\t\t\t\taddAppleTouchIcon( size, base64data );\n\t\t\t\t}\n\t\t\t} )\n\t\t),\n\t\t// The \"normal\" icon should be round. This is used for Chrome\n\t\t// Desktop PWAs. To do: check which sizes are really needed.\n\t\t...[ 180, 192, 512 ].map( ( size ) =>\n\t\t\tcreateIcon( {\n\t\t\t\tsvgElement,\n\t\t\t\tsize,\n\t\t\t\tcolor,\n\t\t\t\tbackgroundColor,\n\t\t\t\tcircle: true,\n\t\t\t} ).then( ( base64data ) => {\n\t\t\t\tmanifest.icons.push( {\n\t\t\t\t\tsrc: base64data,\n\t\t\t\t\tsizes: size + 'x' + size,\n\t\t\t\t\ttype: 'image/png',\n\t\t\t\t\tpurpose: 'any',\n\t\t\t\t} );\n\t\t\t} )\n\t\t),\n\t] ).then( () => {\n\t\taddManifest( manifest );\n\t\twindow.navigator.serviceWorker.register(\n\t\t\taddQueryArgs( adminUrl, { 'service-worker': true } )\n\t\t);\n\t} );\n} );\n"],"names":["exports","Symbol","toStringTag","Object","defineProperty","value","window","createIcon","svgElement","size","color","backgroundColor","circle","Promise","resolve","canvas","document","createElement","context","getContext","padding","logoSize","setAttribute","querySelectorAll","forEach","path","width","height","fillStyle","fillRect","beginPath","arc","Math","PI","closePath","fill","svgBlob","Blob","outerHTML","type","url","URL","createObjectURL","image","src","onload","drawImage","toBlob","imageBlob","revokeObjectURL","reader","FileReader","readAsDataURL","onloadend","result","addEventListener","navigator","logo","siteTitle","adminUrl","wpAdminManifestL10n","manifest","name","display","orientation","start_url","scope","icons","adminBarDummy","id","body","appendChild","getComputedStyle","removeChild","getAdminBarColors","html","doc","implementation","createHTMLDocument","innerHTML","firstElementChild","createSvgElement","all","map","then","base64data","push","sizes","purpose","iconLink","rel","href","head","insertBefore","addAppleTouchIcon","link","encodeURIComponent","JSON","stringify","addManifest","serviceWorker","register","addQueryArgs"],"sourceRoot":""}