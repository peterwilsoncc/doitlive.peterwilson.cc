(()=>{"use strict";const e=window.wp.hooks,t=window.wp.element,n=window.wp.i18n,i=window.wp.blockEditor,l=window.wp.components,o=window.wp.blocks,s=window.lodash,a=window.ReactJSXRuntime,r=syntaxHighlightingCodeBlockLanguageNames,h=e=>{const{highlightedLines:n,...l}=e,o=(0,t.useRef)(),[s,r]=(0,t.useState)({});return(0,t.useEffect)((()=>{if(null!==o.current){const e=o.current,t=window.getComputedStyle(e);r({fontFamily:t.getPropertyValue("font-family"),fontSize:t.getPropertyValue("font-size"),overflow:"hidden",overflowWrap:t.getPropertyValue("overflow-wrap"),resize:t.getPropertyValue("resize")})}}),[l.style]),(0,a.jsxs)(t.Fragment,{children:[(0,a.jsx)(i.RichText,{ref:o,...l}),(0,a.jsx)("div",{"aria-hidden":!0,className:"code-block-overlay",style:s,children:(l.value||"").split(/\n|<br>/i).map(((e,t)=>{let i="loc";return n.has(t)&&(i+=" highlighted"),(0,a.jsx)("span",{className:i,dangerouslySetInnerHTML:{__html:e||" "}},t)}))})]})},c=e=>{const t=new Set;if(!e||0===e.trim().length)return t;let n;const i=e.replace(/\s/,"").split(",");for(n of i)if(n.indexOf("-")>=0){let e;const i=n.split("-");if(2===i.length)for(e=+i[0];e<=+i[1];++e)t.add(e-1)}else t.add(+n-1);return t};function g({attributes:e,setAttributes:g,onRemove:d,insertBlocksAfter:p,mergeBlocks:u}){const w=(0,i.useBlockProps)(),b=(0,s.sortBy)(Object.entries(r).map((([e,t])=>({label:t,value:e}))),(e=>e.label.toLowerCase())),x={tagName:"code",identifier:"content",value:e.content,onChange:e=>g({content:e}),onRemove:d,onMerge:u,placeholder:(0,n.__)("Write codeâ€¦"),"aria-label":(0,n.__)("Code"),preserveWhiteSpace:!0,__unstablePastePlainText:!0,__unstableOnSplitAtDoubleLineEnd:()=>{p((0,o.createBlock)((0,o.getDefaultBlockName)()))},highlightedLines:c(e.highlightedLines),className:["shcb-textedit",e.wrapLines?"shcb-textedit-wrap-lines":""].join(" "),style:w.style};return(0,a.jsxs)(t.Fragment,{children:[(0,a.jsx)(i.InspectorControls,{children:(0,a.jsxs)(l.PanelBody,{title:(0,n.__)("Syntax Highlighting","syntax-highlighting-code-block"),initialOpen:!0,children:[(0,a.jsx)(l.PanelRow,{children:(0,a.jsx)(l.SelectControl,{label:(0,n.__)("Language","syntax-highlighting-code-block"),value:e.language,options:[{label:(0,n.__)("Auto-detect","syntax-highlighting-code-block"),value:""},...b],onChange:e=>{g({language:e})}})}),(0,a.jsx)(l.PanelRow,{children:(0,a.jsx)(l.TextControl,{label:(0,n.__)("Highlighted Lines","syntax-highlighting-code-block"),value:e.highlightedLines,onChange:e=>{g({highlightedLines:e})},help:(0,n.__)("Supported format: 1, 3-5","syntax-highlighting-code-block")})}),(0,a.jsx)(l.PanelRow,{children:(0,a.jsx)(l.CheckboxControl,{label:(0,n.__)("Show Line Numbers","syntax-highlighting-code-block"),checked:e.showLineNumbers,onChange:e=>{g({showLineNumbers:e})}})}),(0,a.jsx)(l.PanelRow,{children:(0,a.jsx)(l.CheckboxControl,{label:(0,n.__)("Wrap Lines","syntax-highlighting-code-block"),checked:e.wrapLines,onChange:e=>{g({wrapLines:e})}})})]})},"controls"),(0,a.jsx)("pre",{...w,children:(0,a.jsx)(h,{...x})})]})}(0,e.addFilter)("blocks.registerBlockType","westonruter/syntax-highlighting-code-block-type",(e=>syntaxHighlightingCodeBlockType.name!==e.name?e:{...e,attributes:{...e.attributes,...syntaxHighlightingCodeBlockType.attributes},edit:g,deprecated:[...e.deprecated||[],{attributes:{...e.attributes,...syntaxHighlightingCodeBlockType.deprecated},isEligible:e=>Object.keys(e).some((e=>syntaxHighlightingCodeBlockType.deprecated.hasOwnProperty(e))),migrate:(e,t)=>[{...e,highlightedLines:e.selectedLines,showLineNumbers:e.showLines},t]}]}))})();