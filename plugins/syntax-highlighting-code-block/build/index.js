(()=>{"use strict";const e=window.wp.hooks,t=window.React,n=window.wp.element,l=window.wp.i18n,i=window.wp.blockEditor,o=window.wp.components,a=window.wp.blocks,r=window.lodash,s=syntaxHighlightingCodeBlockLanguageNames,c=e=>{const{highlightedLines:l,...o}=e,a=(0,n.useRef)(),[r,s]=(0,n.useState)({});return(0,n.useEffect)((()=>{if(null!==a.current){const e=a.current,t=window.getComputedStyle(e);s({fontFamily:t.getPropertyValue("font-family"),fontSize:t.getPropertyValue("font-size"),overflow:"hidden",overflowWrap:t.getPropertyValue("overflow-wrap"),resize:t.getPropertyValue("resize")})}}),[o.style]),(0,t.createElement)(n.Fragment,null,(0,t.createElement)(i.RichText,{ref:a,...o}),(0,t.createElement)("div",{"aria-hidden":!0,className:"code-block-overlay",style:r},(o.value||"").split(/\n|<br>/i).map(((e,n)=>{let i="loc";return l.has(n)&&(i+=" highlighted"),(0,t.createElement)("span",{key:n,className:i,dangerouslySetInnerHTML:{__html:e||" "}})}))))},g=e=>{const t=new Set;if(!e||0===e.trim().length)return t;let n;const l=e.replace(/\s/,"").split(",");for(n of l)if(n.indexOf("-")>=0){let e;const l=n.split("-");if(2===l.length)for(e=+l[0];e<=+l[1];++e)t.add(e-1)}else t.add(+n-1);return t};function h({attributes:e,setAttributes:h,onRemove:d,insertBlocksAfter:u,mergeBlocks:p}){const m=(0,i.useBlockProps)(),w=(0,r.sortBy)(Object.entries(s).map((([e,t])=>({label:t,value:e}))),(e=>e.label.toLowerCase())),b={tagName:"code",identifier:"content",value:e.content,onChange:e=>h({content:e}),onRemove:d,onMerge:p,placeholder:(0,l.__)("Write codeâ€¦"),"aria-label":(0,l.__)("Code"),preserveWhiteSpace:!0,__unstablePastePlainText:!0,__unstableOnSplitAtDoubleLineEnd:()=>{u((0,a.createBlock)((0,a.getDefaultBlockName)()))},highlightedLines:g(e.highlightedLines),className:["shcb-textedit",e.wrapLines?"shcb-textedit-wrap-lines":""].join(" "),style:m.style};return(0,t.createElement)(n.Fragment,null,(0,t.createElement)(i.InspectorControls,{key:"controls"},(0,t.createElement)(o.PanelBody,{title:(0,l.__)("Syntax Highlighting","syntax-highlighting-code-block"),initialOpen:!0},(0,t.createElement)(o.PanelRow,null,(0,t.createElement)(o.SelectControl,{label:(0,l.__)("Language","syntax-highlighting-code-block"),value:e.language,options:[{label:(0,l.__)("Auto-detect","syntax-highlighting-code-block"),value:""},...w],onChange:e=>{h({language:e})}})),(0,t.createElement)(o.PanelRow,null,(0,t.createElement)(o.TextControl,{label:(0,l.__)("Highlighted Lines","syntax-highlighting-code-block"),value:e.highlightedLines,onChange:e=>{h({highlightedLines:e})},help:(0,l.__)("Supported format: 1, 3-5","syntax-highlighting-code-block")})),(0,t.createElement)(o.PanelRow,null,(0,t.createElement)(o.CheckboxControl,{label:(0,l.__)("Show Line Numbers","syntax-highlighting-code-block"),checked:e.showLineNumbers,onChange:e=>{h({showLineNumbers:e})}})),(0,t.createElement)(o.PanelRow,null,(0,t.createElement)(o.CheckboxControl,{label:(0,l.__)("Wrap Lines","syntax-highlighting-code-block"),checked:e.wrapLines,onChange:e=>{h({wrapLines:e})}})))),(0,t.createElement)("pre",{...m},(0,t.createElement)(c,{...b})))}(0,e.addFilter)("blocks.registerBlockType","westonruter/syntax-highlighting-code-block-type",(e=>syntaxHighlightingCodeBlockType.name!==e.name?e:{...e,attributes:{...e.attributes,...syntaxHighlightingCodeBlockType.attributes},edit:h,deprecated:[...e.deprecated||[],{attributes:{...e.attributes,...syntaxHighlightingCodeBlockType.deprecated},isEligible:e=>Object.keys(e).some((e=>syntaxHighlightingCodeBlockType.deprecated.hasOwnProperty(e))),migrate:(e,t)=>[{...e,highlightedLines:e.selectedLines,showLineNumbers:e.showLines},t]}]}))})();